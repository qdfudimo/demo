<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>表格导出PDF示例</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            letter-spacing: -0.5px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .controls {
            padding: 25px;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 160px;
            justify-content: center;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #10b981, #34d399);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .btn:active {
            transform: translateY(-1px);
        }
        
        .btn i {
            font-size: 18px;
        }
        
        .table-container {
            padding: 30px;
            overflow-x: auto;
        }
        
        #dataTable {
            width: 100%;
            border-collapse: collapse;
            font-size: 15px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        #dataTable th {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
            font-weight: 600;
            padding: 18px 15px;
            text-align: left;
            position: sticky;
            top: 0;
        }
        
        #dataTable td {
            padding: 16px 15px;
            border-bottom: 1px solid #f1f5f9;
            vertical-align: middle;
        }
        
        #dataTable tr:hover {
            background-color: #f8fafc;
        }
        
        #dataTable tr:nth-child(even) {
            background-color: #f8fafc;
        }
        
        .status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }
        
        .status-active {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        .status-pending {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .status-inactive {
            background-color: #fee2e2;
            color: #991b1b;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e5e7eb;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 5px;
        }
        
        .progress-70 { width: 70%; background: linear-gradient(90deg, #10b981, #34d399); }
        .progress-85 { width: 85%; background: linear-gradient(90deg, #3b82f6, #60a5fa); }
        .progress-60 { width: 60%; background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .progress-90 { width: 90%; background: linear-gradient(90deg, #8b5cf6, #a78bfa); }
        .progress-45 { width: 45%; background: linear-gradient(90deg, #ef4444, #f87171); }
        
        .features {
            padding: 25px 30px;
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
        }
        
        .features h3 {
            margin-bottom: 15px;
            color: #1e293b;
            font-size: 1.5rem;
        }
        
        .features ul {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            list-style: none;
        }
        
        .features li {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
        }
        
        .features li i {
            color: #4f46e5;
            font-size: 20px;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 20px 10px;
            }
            
            .container {
                border-radius: 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .btn {
                width: 100%;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .table-container {
                padding: 15px;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-file-pdf"></i> 表格导出PDF示例</h1>
            <p class="subtitle">使用 jsPDF + AutoTable 生成专业报表</p>
        </header>
        
        <div class="controls">
            <button class="btn btn-primary" onclick="exportBasicTable()">
                <i class="fas fa-download"></i> 导出基础表格
            </button>
            <button class="btn btn-secondary" onclick="exportStyledTable()">
                <i class="fas fa-palette"></i> 导出样式表格
            </button>
            <button class="btn btn-warning" onclick="exportComplexTable()">
                <i class="fas fa-chart-bar"></i> 导出复杂报表
            </button>
            <button class="btn btn-primary" onclick="exportFromHTML()">
                <i class="fas fa-code"></i> 从HTML导出
            </button>
        </div>
        
        <div class="table-container">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>姓名</th>
                        <th>部门</th>
                        <th>职位</th>
                        <th>状态</th>
                        <th>入职日期</th>
                        <th>薪资</th>
                        <th>项目进度</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>001</td>
                        <td><i class="fas fa-user"></i> 张三</td>
                        <td>技术部</td>
                        <td>前端工程师</td>
                        <td><span class="status status-active">在职</span></td>
                        <td>2022-03-15</td>
                        <td>¥18,500</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill progress-70"></div>
                            </div>
                            <small>70%</small>
                        </td>
                    </tr>
                    <tr>
                        <td>002</td>
                        <td><i class="fas fa-user"></i> 李四</td>
                        <td>设计部</td>
                        <td>UI设计师</td>
                        <td><span class="status status-active">在职</span></td>
                        <td>2021-08-22</td>
                        <td>¥16,000</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill progress-85"></div>
                            </div>
                            <small>85%</small>
                        </td>
                    </tr>
                    <tr>
                        <td>003</td>
                        <td><i class="fas fa-user"></i> 王五</td>
                        <td>市场部</td>
                        <td>营销经理</td>
                        <td><span class="status status-pending">休假</span></td>
                        <td>2020-11-30</td>
                        <td>¥22,000</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill progress-60"></div>
                            </div>
                            <small>60%</small>
                        </td>
                    </tr>
                    <tr>
                        <td>004</td>
                        <td><i class="fas fa-user"></i> 赵六</td>
                        <td>技术部</td>
                        <td>后端工程师</td>
                        <td><span class="status status-active">在职</span></td>
                        <td>2023-01-10</td>
                        <td>¥20,000</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill progress-90"></div>
                            </div>
                            <small>90%</small>
                        </td>
                    </tr>
                    <tr>
                        <td>005</td>
                        <td><i class="fas fa-user"></i> 钱七</td>
                        <td>财务部</td>
                        <td>财务主管</td>
                        <td><span class="status status-inactive">离职</span></td>
                        <td>2019-05-18</td>
                        <td>¥25,000</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill progress-45"></div>
                            </div>
                            <small>45%</small>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="features">
            <h3><i class="fas fa-star"></i> 支持的PDF功能</h3>
            <ul>
                <li><i class="fas fa-check-circle"></i> 自动分页处理</li>
                <li><i class="fas fa-check-circle"></i> 自定义表格样式</li>
                <li><i class="fas fa-check-circle"></i> 页眉和页脚</li>
                <li><i class="fas fa-check-circle"></i> 图片和LOGO插入</li>
                <li><i class="fas fa-check-circle"></i> 多表格组合</li>
                <li><i class="fas fa-check-circle"></i> 表格合并与拆分</li>
                <li><i class="fas fa-check-circle"></i> 自定义字体支持</li>
                <li><i class="fas fa-check-circle"></i> 水印和背景图</li>
            </ul>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script>
        // 确保jsPDF可用
        const { jsPDF } = window.jspdf;
        
        // 1. 基础表格导出
        function exportBasicTable() {
            const doc = new jsPDF('p', 'pt', 'a4');
            
            // 添加标题
            doc.setFontSize(20);
            doc.setTextColor(40, 40, 40);
            doc.text('员工信息表', doc.internal.pageSize.width / 2, 40, { align: 'center' });
            
            // 添加日期
            doc.setFontSize(11);
            doc.setTextColor(100, 100, 100);
            doc.text(`生成日期: ${new Date().toLocaleDateString()}`, doc.internal.pageSize.width / 2, 65, { align: 'center' });
            
            // 创建表格数据
            const tableData = [
                ['ID', '姓名', '部门', '职位', '状态', '入职日期', '薪资'],
                ['001', '张三', '技术部', '前端工程师', '在职', '2022-03-15', '¥18,500'],
                ['002', '李四', '设计部', 'UI设计师', '在职', '2021-08-22', '¥16,000'],
                ['003', '王五', '市场部', '营销经理', '休假', '2020-11-30', '¥22,000'],
                ['004', '赵六', '技术部', '后端工程师', '在职', '2023-01-10', '¥20,000'],
                ['005', '钱七', '财务部', '财务主管', '离职', '2019-05-18', '¥25,000']
            ];
            
            // 生成表格
            doc.autoTable({
                head: [tableData[0]],
                body: tableData.slice(1),
                startY: 90,
                theme: 'striped',
                headStyles: {
                    fillColor: [79, 70, 229],
                    textColor: 255,
                    fontSize: 12,
                    fontStyle: 'bold'
                },
                bodyStyles: {
                    fontSize: 11,
                    cellPadding: 8
                },
                alternateRowStyles: {
                    fillColor: [248, 250, 252]
                },
                margin: { left: 40, right: 40 },
                didDrawPage: function(data) {
                    // 页脚
                    doc.setFontSize(10);
                    doc.setTextColor(150, 150, 150);
                    doc.text(`第 ${doc.internal.getNumberOfPages()} 页`, data.settings.margin.left, doc.internal.pageSize.height - 20);
                }
            });
            
            doc.save('基础员工表.pdf');
        }
        
        // 2. 样式丰富的表格导出
        function exportStyledTable() {
            const doc = new jsPDF('p', 'pt', 'a4');
            
            // 添加标题和副标题
            doc.setFontSize(24);
            doc.setTextColor(79, 70, 229);
            doc.text('公司员工报表', doc.internal.pageSize.width / 2, 50, { align: 'center' });
            
            doc.setFontSize(14);
            doc.setTextColor(100, 116, 139);
            doc.text('2023年度第二季度', doc.internal.pageSize.width / 2, 80, { align: 'center' });
            
            // 添加公司信息
            doc.setFontSize(11);
            doc.setTextColor(71, 85, 105);
            doc.text('公司名称: 示例科技有限公司', 50, 110);
            doc.text('报表类型: 人力资源报告', 50, 130);
            doc.text(`生成时间: ${new Date().toLocaleString()}`, doc.internal.pageSize.width - 50, 110, { align: 'right' });
            
            // 表格数据
            const tableData = [
                { id: '001', name: '张三', department: '技术部', position: '前端工程师', status: '在职', salary: 18500, joinDate: '2022-03-15', performance: 85 },
                { id: '002', name: '李四', department: '设计部', position: 'UI设计师', status: '在职', salary: 16000, joinDate: '2021-08-22', performance: 92 },
                { id: '003', name: '王五', department: '市场部', position: '营销经理', status: '休假', salary: 22000, joinDate: '2020-11-30', performance: 78 },
                { id: '004', name: '赵六', department: '技术部', position: '后端工程师', status: '在职', salary: 20000, joinDate: '2023-01-10', performance: 88 },
                { id: '005', name: '钱七', department: '财务部', position: '财务主管', status: '离职', salary: 25000, joinDate: '2019-05-18', performance: 65 }
            ];
            
            // 转换数据为表格格式
            const tableRows = tableData.map(row => [
                row.id,
                row.name,
                row.department,
                row.position,
                row.status,
                row.joinDate,
                '¥' + row.salary.toLocaleString(),
                row.performance + '%'
            ]);
            
            // 生成主表格
            doc.autoTable({
                head: [['员工ID', '姓名', '部门', '职位', '状态', '入职日期', '薪资', '绩效']],
                body: tableRows,
                startY: 150,
                theme: 'grid',
                headStyles: {
                    fillColor: [15, 118, 110],
                    textColor: 255,
                    fontSize: 12,
                    fontStyle: 'bold',
                    halign: 'center'
                },
                bodyStyles: {
                    fontSize: 11,
                    cellPadding: 7,
                    halign: 'center'
                },
                columnStyles: {
                    0: { cellWidth: 60, halign: 'center' },
                    1: { cellWidth: 80 },
                    4: { 
                        cellWidth: 70,
                        fillColor: [240, 253, 244]
                    },
                    6: { 
                        cellWidth: 90,
                        fontStyle: 'bold',
                        textColor: [21, 128, 61]
                    },
                    7: { 
                        cellWidth: 70,
                        fillColor: [239, 246, 255]
                    }
                },
                didParseCell: function(data) {
                    // 根据状态设置颜色
                    if (data.column.index === 4) {
                        if (data.cell.raw === '在职') {
                            data.cell.styles.fillColor = [220, 252, 231];
                            data.cell.styles.textColor = [21, 128, 61];
                        } else if (data.cell.raw === '休假') {
                            data.cell.styles.fillColor = [254, 243, 199];
                            data.cell.styles.textColor = [146, 64, 14];
                        } else {
                            data.cell.styles.fillColor = [254, 226, 226];
                            data.cell.styles.textColor = [153, 27, 27];
                        }
                    }
                    
                    // 高亮绩效优秀的员工
                    if (data.column.index === 7) {
                        const performance = parseInt(data.cell.raw);
                        if (performance >= 90) {
                            data.cell.styles.fillColor = [220, 252, 231];
                            data.cell.styles.textColor = [21, 128, 61];
                            data.cell.styles.fontStyle = 'bold';
                        } else if (performance < 70) {
                            data.cell.styles.fillColor = [254, 226, 226];
                            data.cell.styles.textColor = [153, 27, 27];
                        }
                    }
                },
                margin: { left: 40, right: 40 },
                didDrawPage: function(data) {
                    // 添加页脚
                    const pageCount = doc.internal.getNumberOfPages();
                    doc.setFontSize(10);
                    doc.setTextColor(150, 150, 150);
                    doc.text(`机密文件 - 第 ${data.pageNumber} 页 / 共 ${pageCount} 页`, doc.internal.pageSize.width / 2, doc.internal.pageSize.height - 30, { align: 'center' });
                    
                    // 添加公司水印
                    doc.setFontSize(60);
                    doc.setTextColor(240, 240, 240);
                    doc.text('tesstt', doc.internal.pageSize.width / 2, doc.internal.pageSize.height / 2, { align: 'center', angle: 45 });
                }
            });
            
            // 添加汇总信息
            const finalY = doc.lastAutoTable.finalY + 30;
            doc.setFontSize(14);
            doc.setTextColor(79, 70, 229);
            doc.text('1231', 50, finalY);
            
            doc.setFontSize(11);
            doc.setTextColor(71, 85, 105);
            
            const totalEmployees = tableData.length;
            const activeEmployees = tableData.filter(e => e.status === '在职').length;
            const avgSalary = tableData.reduce((sum, e) => sum + e.salary, 0) / totalEmployees;
            const avgPerformance = tableData.reduce((sum, e) => sum + e.performance, 0) / totalEmployees;
            
            doc.text(`员工总数: ${totalEmployees}人`, 50, finalY + 25);
            doc.text(`在职员工: ${activeEmployees}人`, 50, finalY + 45);
            doc.text(`平均薪资: ¥${avgSalary.toLocaleString('zh-CN', { maximumFractionDigits: 0 })}`, 50, finalY + 65);
            doc.text(`平均绩效: ${avgPerformance.toFixed(1)}%`, 50, finalY + 85);
            
            doc.save('样式丰富的员工报表.pdf');
        }
        
        // 3. 复杂报表（多表格）
        function exportComplexTable() {
            const doc = new jsPDF('l', 'pt', 'a4');
            
            // 标题和LOGO位置
            doc.setFontSize(28);
            doc.setTextColor(30, 41, 59);
            doc.text('公司季度业绩报告', doc.internal.pageSize.width / 2, 50, { align: 'center' });
            
            doc.setFontSize(14);
            doc.setTextColor(100, 116, 139);
            doc.text('2023年第三季度 (7月-9月)', doc.internal.pageSize.width / 2, 80, { align: 'center' });
            
            // 第一个表格：部门业绩
            const deptData = [
                ['部门', '目标(万)', '实际(万)', '完成率', '同比增长', '部门负责人'],
                ['技术部', '850', '920', '108.2%', '12.5%', '张经理'],
                ['市场部', '1200', '1150', '95.8%', '8.2%', '李总监'],
                ['销售部', '2000', '2180', '109.0%', '15.3%', '王总'],
                ['客服部', '300', '320', '106.7%', '5.6%', '赵主管'],
                ['行政部', '150', '145', '96.7%', '2.1%', '刘主任']
            ];
            
            doc.autoTable({
                head: [deptData[0]],
                body: deptData.slice(1),
                startY: 110,
                theme: 'striped',
                headStyles: {
                    fillColor: [30, 41, 59],
                    textColor: 255,
                    fontSize: 12,
                    fontStyle: 'bold',
                    halign: 'center'
                },
                bodyStyles: {
                    fontSize: 11,
                    cellPadding: 8,
                    halign: 'center'
                },
                columnStyles: {
                    3: {
                        cellWidth: 80,
                        fillColor: [239, 246, 255]
                    },
                    4: {
                        cellWidth: 80
                    }
                },
                didParseCell: function(data) {
                    // 高亮完成率
                    if (data.column.index === 3 && data.row.index > 0) {
                        const rate = parseFloat(data.cell.raw);
                        if (rate > 105) {
                            data.cell.styles.fillColor = [220, 252, 231];
                            data.cell.styles.textColor = [21, 128, 61];
                            data.cell.styles.fontStyle = 'bold';
                        } else if (rate < 95) {
                            data.cell.styles.fillColor = [254, 226, 226];
                            data.cell.styles.textColor = [153, 27, 27];
                        }
                    }
                }
            });
            
            // 第二个表格：员工绩效排名
            const performanceData = [
                ['排名', '员工姓名', '部门', '岗位', '季度绩效', '客户评分', '上级评分'],
                ['1', '张三', '销售部', '销售专员', '98.5', '96', '100'],
                ['2', '李四', '技术部', '高级工程师', '97.2', '95', '98'],
                ['3', '王五', '市场部', '市场专员', '95.8', '97', '94'],
                ['4', '赵六', '客服部', '客服主管', '94.3', '99', '92'],
                ['5', '钱七', '技术部', '前端工程师', '93.7', '94', '95'],
                ['6', '孙八', '销售部', '销售经理', '92.5', '93', '94'],
                ['7', '周九', '行政部', '行政助理', '90.2', '91', '92'],
                ['8', '吴十', '市场部', '品牌专员', '89.8', '92', '90']
            ];
            
            doc.autoTable({
                head: [performanceData[0]],
                body: performanceData.slice(1),
                startY: doc.lastAutoTable.finalY + 30,
                theme: 'grid',
                headStyles: {
                    fillColor: [124, 58, 237],
                    textColor: 255,
                    fontSize: 12,
                    fontStyle: 'bold',
                    halign: 'center'
                },
                bodyStyles: {
                    fontSize: 11,
                    cellPadding: 7,
                    halign: 'center'
                },
                columnStyles: {
                    0: { cellWidth: 60 },
                    1: { cellWidth: 90 },
                    4: { 
                        cellWidth: 80,
                        fontStyle: 'bold'
                    }
                },
                didParseCell: function(data) {
                    // 高亮前三名
                    if (data.column.index === 0 && data.row.index > 0) {
                        const rank = parseInt(data.cell.raw);
                        if (rank <= 3) {
                            data.row.styles.fillColor = [255, 251, 235];
                            data.cell.styles.fontStyle = 'bold';
                            data.cell.styles.textColor = [202, 138, 4];
                        }
                    }
                }
            });
            
            // 添加总结部分
            const finalY = doc.lastAutoTable.finalY + 30;
            doc.setFontSize(16);
            doc.setTextColor(30, 41, 59);
            doc.text('季度总结', 50, finalY);
            
            doc.setFontSize(11);
            doc.setTextColor(71, 85, 105);
            
            const summary = [
                '1. 本季度公司整体业绩达成率为105.6%，超额完成目标',
                '2. 销售部表现突出，完成率达109%，同比增长15.3%',
                '3. 技术部创新项目获得客户高度评价，客户满意度达98%',
                '4. 市场部在新渠道拓展方面取得突破性进展',
                '5. 下一季度重点：加强部门协作，提升行政效率'
            ];
            
            summary.forEach((item, index) => {
                doc.text(item, 50, finalY + 30 + (index * 20));
            });
            
            // 添加页脚
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(10);
                doc.setTextColor(150, 150, 150);
                doc.text(`公司机密 - 第 ${i} 页`, doc.internal.pageSize.width - 50, doc.internal.pageSize.height - 30, { align: 'right' });
                doc.text(`生成时间: ${new Date().toLocaleDateString()}`, 50, doc.internal.pageSize.height - 30);
            }
            
            doc.save('复杂季度报表.pdf');
        }
        
        // 4. 从现有HTML表格导出
        function exportFromHTML() {
            const doc = new jsPDF('p', 'pt', 'a4');
            const table = document.getElementById('dataTable');
            
            // 添加标题
            doc.setFontSize(20);
            doc.setTextColor(40, 40, 40);
            doc.text('HTML表格导出示例', doc.internal.pageSize.width / 2, 40, { align: 'center' });
            
            // 从HTML表格提取数据
            const headers = [];
            const rows = [];
            
            // 获取表头
            const headerCells = table.querySelectorAll('thead th');
            headerCells.forEach(cell => {
                // 移除图标和额外空格
                let text = cell.innerText.trim();
                headers.push(text);
            });
            
            // 获取表格行数据
            const tableRows = table.querySelectorAll('tbody tr');
            tableRows.forEach(row => {
                const rowData = [];
                const cells = row.querySelectorAll('td');
                
                cells.forEach((cell, index) => {
                    let text = cell.innerText.trim();
                    
                    // 处理特殊列
                    if (index === 4) {
                        // 状态列，只取文本（去除HTML标记）
                        text = cell.querySelector('.status')?.innerText || text;
                    } else if (index === 7) {
                        // 进度列，提取百分比数字
                        const percentMatch = text.match(/(\d+)%/);
                        text = percentMatch ? percentMatch[0] : text;
                    } else if (index === 0) {
                        // ID列，保持原样
                    } else {
                        // 其他列，移除可能存在的图标
                        text = text.replace(/[\uE000-\uF8FF]/g, '');
                    }
                    
                    rowData.push(text);
                });
                
                rows.push(rowData);
            });
            
            // 生成PDF表格
            doc.autoTable({
                head: [headers],
                body: rows,
                startY: 80,
                theme: 'grid',
                headStyles: {
                    fillColor: [59, 130, 246],
                    textColor: 255,
                    fontSize: 12,
                    fontStyle: 'bold'
                },
                bodyStyles: {
                    fontSize: 11,
                    cellPadding: 8
                },
                columnStyles: {
                    4: { // 状态列
                        cellWidth: 70,
                        fillColor: [240, 253, 244]
                    },
                    6: { // 薪资列
                        cellWidth: 90,
                        fontStyle: 'bold',
                        textColor: [21, 128, 61]
                    }
                },
                didParseCell: function(data) {
                    // 根据状态设置颜色
                    if (data.column.index === 4) {
                        const status = data.cell.raw;
                        if (status === '在职') {
                            data.cell.styles.fillColor = [220, 252, 231];
                            data.cell.styles.textColor = [21, 128, 61];
                        } else if (status === '休假') {
                            data.cell.styles.fillColor = [254, 243, 199];
                            data.cell.styles.textColor = [146, 64, 14];
                        } else if (status === '离职') {
                            data.cell.styles.fillColor = [254, 226, 226];
                            data.cell.styles.textColor = [153, 27, 27];
                        }
                    }
                },
                margin: { left: 40, right: 40 },
                didDrawPage: function(data) {
                    // 添加页脚
                    doc.setFontSize(10);
                    doc.setTextColor(150, 150, 150);
                    doc.text('从HTML表格自动生成', doc.internal.pageSize.width / 2, doc.internal.pageSize.height - 20, { align: 'center' });
                }
            });
            
            doc.save('HTML表格导出.pdf');
        }
    </script>
</body>
</html>